import socket
import sys

'''
with open('logging.txt', 'a') as file:
    file.write('\n' + 'Hey')
    file.write('\n')
    file.write('Hey')
    file.close()
'''

host = ''
port = 123

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
# s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
print('[*] Socket created successfully.')

try:
    s.bind((host, port))

except socket.error as err:
    print('[-] Binding failed. Exiting.')
    sys.exit()
print('[*] Socket bound successfully.')

s.listen(5)
conn, addr = s.accept()
data = conn.recv(512)  # Receives a specified number of bytes of data from the client side.

# print(data)

# For this block of code to work, you gotta input data from the client that connected to the server.
# This data is then written to file with the IP address of the connecting host.
if data:
    log = open('logging.pt', 'a')
    print('[*] Connection from address:', addr[0])
    log.write('\n' + addr[0])
    log.write(':')
    log.write(data.decode('utf-8'))
    log.close()
    print('[*] Client data written to file.')

# s.close()
